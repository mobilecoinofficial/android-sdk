package com.mobilecoin.lib;

import static org.junit.Assert.assertEquals;

import android.net.Uri;
import androidx.test.ext.junit.runners.AndroidJUnit4;
import com.mobilecoin.api.MobileCoinAPI;
import com.mobilecoin.lib.util.Hex;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.List;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;

@RunWith(AndroidJUnit4.class)
public class TxOutMemoIntegrationTest {

  private static final String senderAccountKeyHexBytes = "0a220a20ec8cb9814ac5c1a4aacbc613e756744679050927cc9e5f8772c6d649d4a5ac0612220a20e7ef0b2772663314ecd7ee92008613764ab5669666d95bd2621d99d60506cb0d1a1e666f673a2f2f666f672e616c7068612e6d6f62696c65636f696e2e636f6d2aa60430820222300d06092a864886f70d01010105000382020f003082020a0282020100c853a8724bc211cf5370ed4dbec8947c5573bed0ec47ae14211454977b41336061f0a040f77dbf529f3a46d8095676ec971b940ab4c9642578760779840a3f9b3b893b2f65006c544e9c16586d33649769b7c1c94552d7efa081a56ad612dec932812676ebec091f2aed69123604f4888a125e04ff85f5a727c286664378581cf34c7ee13eb01cc4faf3308ed3c07a9415f98e5fbfe073e6c357967244e46ba6ebbe391d8154e6e4a1c80524b1a6733eca46e37bfdd62d75816988a79aac6bdb62a06b1237a8ff5e5c848d01bbff684248cf06d92f301623c893eb0fba0f3faee2d197ea57ac428f89d6c000f76d58d5aacc3d70204781aca45bc02b1456b454231d2f2ed4ca6614e5242c7d7af0fe61e9af6ecfa76674ffbc29b858091cbfb4011538f0e894ce45d21d7fac04ba2ff57e9ff6db21e2afd9468ad785c262ec59d4a1a801c5ec2f95fc107dc9cb5f7869d70aa84450b8c350c2fa48bddef20752a1e43676b246c7f59f8f1f4aee43c1a15f36f7a36a9ec708320ea42089991551f2656ec62ea38233946b85616ff182cf17cd227e596329b546ea04d13b053be4cf3338de777b50bc6eca7a6185cf7a5022bc9be3749b1bb43e10ecc88a0c580f2b7373138ee49c7bafd8be6a64048887230480b0c85a045255494e04a9a81646369ce7a10e08da6fae27333ec0c16c8a74d93779a9e055395078d0b07286f9930203010001";
  private static final String recipientAccountKeyHexBytes = "0a220a20553a1c51c1e91d3105b17c909c163f8bc6faf93718deb06e5b9fdb9a24c2560912220a20db8b25545216d606fc3ff6da43d3281e862ba254193aff8c408f3564aefca5061a1e666f673a2f2f666f672e616c7068612e6d6f62696c65636f696e2e636f6d2aa60430820222300d06092a864886f70d01010105000382020f003082020a0282020100c853a8724bc211cf5370ed4dbec8947c5573bed0ec47ae14211454977b41336061f0a040f77dbf529f3a46d8095676ec971b940ab4c9642578760779840a3f9b3b893b2f65006c544e9c16586d33649769b7c1c94552d7efa081a56ad612dec932812676ebec091f2aed69123604f4888a125e04ff85f5a727c286664378581cf34c7ee13eb01cc4faf3308ed3c07a9415f98e5fbfe073e6c357967244e46ba6ebbe391d8154e6e4a1c80524b1a6733eca46e37bfdd62d75816988a79aac6bdb62a06b1237a8ff5e5c848d01bbff684248cf06d92f301623c893eb0fba0f3faee2d197ea57ac428f89d6c000f76d58d5aacc3d70204781aca45bc02b1456b454231d2f2ed4ca6614e5242c7d7af0fe61e9af6ecfa76674ffbc29b858091cbfb4011538f0e894ce45d21d7fac04ba2ff57e9ff6db21e2afd9468ad785c262ec59d4a1a801c5ec2f95fc107dc9cb5f7869d70aa84450b8c350c2fa48bddef20752a1e43676b246c7f59f8f1f4aee43c1a15f36f7a36a9ec708320ea42089991551f2656ec62ea38233946b85616ff182cf17cd227e596329b546ea04d13b053be4cf3338de777b50bc6eca7a6185cf7a5022bc9be3749b1bb43e10ecc88a0c580f2b7373138ee49c7bafd8be6a64048887230480b0c85a045255494e04a9a81646369ce7a10e08da6fae27333ec0c16c8a74d93779a9e055395078d0b07286f9930203010001";
  private static final String fogAlphaUri = "fog://fog.alpha.mobilecoin.com:443/";
  private static final String serializedAlphaNetReportResponse = "0ab71e12ab1e0a83020a800272af3c371202876b401b70c477be1b72684c90552232012c83144e1c3682a23b7beb9313f0d601032c86ec251a7e23aaa2749f8365f07af9c6631e53c253a854519b1ef903a0fef02853f2026de0531bdd4be21e5f44d337f77603fca53aff4289928e0c857b1bbc84efd94467ce83ad6d46bbffe167add76b3d074a9e12222a592e0d9eb8e27df1b960da2064edac4f907dab3fb4f279d2a0f67c8910ad38148d752d11625318dc8c1f852d3c926b52a0c6ed37528459f73524beb7290031bbbe0ef028d21ef286a6763006740de9ff7f0312ff55e83f54c89274fec01078da692299a3deaea79fb6c461d2f066f4e7dc26cce9d65bff638da48d451049b30612a509308204a130820309a003020102020900d107765d32a3b096300d06092a864886f70d01010b0500307e310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e3130302e06035504030c27496e74656c20534758204174746573746174696f6e205265706f7274205369676e696e67204341301e170d3136313132323039333635385a170d3236313132303039333635385a307b310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e312d302b06035504030c24496e74656c20534758204174746573746174696f6e205265706f7274205369676e696e6730820122300d06092a864886f70d01010105000382010f003082010a0282010100a97a2de0e66ea6147c9ee745ac0162686c7192099afc4b3f040fad6de093511d74e802f510d716038157dcaf84f4104bd3fed7e6b8f99c8817fd1ff5b9b864296c3d81fa8f1b729e02d21d72ffee4ced725efe74bea68fbc4d4244286fcdd4bf64406a439a15bcb4cf67754489c423972b4a80df5c2e7c5bc2dbaf2d42bb7b244f7c95bf92c75d3b33fc5410678a89589d1083da3acc459f2704cd99598c275e7c1878e00757e5bdb4e840226c11c0a17ff79c80b15c1ddb5af21cc2417061fbd2a2da819ed3b72b7efaa3bfebe2805c9b8ac19aa346512d484cfc81941e15f55881cc127e8f7aa12300cd5afb5742fa1d20cb467a5beb1c666cf76a368978b50203010001a381a43081a1301f0603551d2304183016801478437b76a67ebcd0af7e4237eb357c3b8701513c300e0603551d0f0101ff0404030206c0300c0603551d130101ff0402300030600603551d1f045930573055a053a051864f687474703a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f43524c2f5347582f4174746573746174696f6e5265706f72745369676e696e6743412e63726c300d06092a864886f70d01010b050003820181006708b61b5c2bd215473e2b46af99284fbb939d3f3b152c996f1a6af3b329bd220b1d3b610f6bce2e6753bded304db21912f385256216cfcba456bd96940be892f5690c260d1ef84f1606040222e5fe08e5326808212a447cfdd64a46e94bf29f6b4b9a721d25b3c4e2f62f58baed5d77c505248f0f801f9fbfb7fd752080095cee80938b339f6dbb4e165600e20e4a718812d49d9901e310a9b51d66c79909c6996599fae6d76a79ef145d9943bf1d3e35d3b42d1fb9a45cbe8ee334c166eee7d32fcdc9935db8ec8bb1d8eb3779dd8ab92b6e387f0147450f1e381d08581fb83df33b15e000a59be57ea94a3a52dc64bdaec959b3464c91e725bbdaea3d99e857e380a23c9d9fb1ef58e9e42d71f12130f9261d7234d6c37e2b03dba40dfdfb13ac4ad8e13fd3756356b6b50015a3ec9580b815d87c2cef715cd28df00bbf2a3c403ebf6691b3f05edd9143803ca085cff57e053eec2f8fea46ea778a68c9be885bc28225bc5f309be4a2b74d3a03945319dd3c7122fed6ff53bb8b8cb3a03c12cf0a3082054b308203b3a003020102020900d107765d32a3b094300d06092a864886f70d01010b0500307e310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e3130302e06035504030c27496e74656c20534758204174746573746174696f6e205265706f7274205369676e696e672043413020170d3136313131343135333733315a180f32303439313233313233353935395a307e310b3009060355040613025553310b300906035504080c0243413114301206035504070c0b53616e746120436c617261311a3018060355040a0c11496e74656c20436f72706f726174696f6e3130302e06035504030c27496e74656c20534758204174746573746174696f6e205265706f7274205369676e696e67204341308201a2300d06092a864886f70d01010105000382018f003082018a02820181009f3c647eb5773cbb512d2732c0d7415ebb55a0fa9ede2e649199e6821db910d53177370977466a6a5e4786ccd2ddebd4149d6a2f6325529dd10cc98737b0779c1a07e29c47a1ae004948476c489f45a5a15d7ac8ecc6acc645adb43d87679df59c093bc5a2e9696c5478541b979e754b573914be55d32ff4c09ddf27219934cd990527b3f92ed78fbf29246abecb71240ef39c2d7107b447545a7ffb10eb060a68a98580219e36910952683892d6a5e2a80803193e407531404e36b315623799aa825074409754a2dfe8f5afd5fe631e1fc2af3808906f28a790d9dd9fe060939b125790c5805d037df56a99531b96de69de33ed226cc1207d1042b5c9ab7f404fc711c0fe4769fb9578b1dc0ec469ea1a25e0ff9914886ef2699b235bb4847dd6ff40b606e6170793c2fb98b314587f9cfd257362dfeab10b3bd2d97673a1a4bd44c453aaf47fc1f2d3d0f384f74a06f89c089f0da6cdb7fceee8c9821a8e54f25c0416d18c46839a5f8012fbdd3dc74d256279adc2c0d55aff6f0622425d1b0203010001a381c93081c630600603551d1f045930573055a053a051864f687474703a2f2f7472757374656473657276696365732e696e74656c2e636f6d2f636f6e74656e742f43524c2f5347582f4174746573746174696f6e5265706f72745369676e696e6743412e63726c301d0603551d0e0416041478437b76a67ebcd0af7e4237eb357c3b8701513c301f0603551d2304183016801478437b76a67ebcd0af7e4237eb357c3b8701513c300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100300d06092a864886f70d01010b05000382018100785f2d60c5c80af42a797610213915da82c9b29e89e0902a25a6c75b16091c68ab204aae711889492c7e1e320911455a8fc13442312e77a63994d99795c8ea4576823cea8ad1e191cfa862fab8a932d3d9b0535a0702d0555f74e520e30330f33480e7adc9d7c81e20703142bf00c528a80b463381fd602a82c7035281aae59562ccb5334ea8903e650b010681f5ce8eb62eac9c414988243aec92f25bf13cdff7ebcc298ee51bba5a3538b66b26cbc45a51de003cad306531ad7cf5d4ef0f8805d1b9133d24135ab3c4641a2f8808349d7333295e0e76ee4bc5227232628efa80d79d92ab4e3d1120f3fb5ad119cd8d544aa1d4a6865e6b57beac5771307e2e3cb9070da47b4bfc8869e01413ea093541de8a792811b74636c5e91452cf0cee59f2fb404acd0bc584cb9c835404734c0e7ec6605cdfcf2ff439b6d4719f702f0e0c3fa04fdb12a6cb2ad1ab1c9af1f8f4c3a08edd72a32b0bb5d0ad256ffd159a683b2a5a1f1d11fa62532f03d754caef0da5735a1e5a884c7e89d91218c9d71aa8087b226e6f6e6365223a226433376239656336333338326265303633393062306131653164666433323033222c226964223a223630303931393437343233363231303932343137393933333933393238323937363430303935222c2274696d657374616d70223a22323032312d30392d32315431323a35333a35322e373433333239222c2276657273696f6e223a342c226570696450736575646f6e796d223a226734634c36766e364d394944545053716858385066375372392b54377a3467446f3941533835735274547a622f54774e6c5857696e4a7663333243614d7959784253343742617354305832382b735a637769766a557869514b4558716f39577435615530457a6241774e6f44524c5543566a357467654b565973627935617a54652b7951727152325173566c54584c6e786f66515879464b39455371455932332f676455424d79484a556b3d222c2261647669736f727955524c223a2268747470733a2f2f73656375726974792d63656e7465722e696e74656c2e636f6d222c2261647669736f7279494473223a5b22494e54454c2d53412d3030333334225d2c22697376456e636c61766551756f7465537461747573223a2253575f48415244454e494e475f4e4545444544222c22697376456e636c61766551756f7465426f6479223a224167414241424d4d4141414d4141734141414141414a6136314635484b3458754e2b687055416f734644554141414141414141414141414141414141414141414552454442662b41426741414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414142774141414141414141414841414141414141414150346c5249424635466f344736666c4143792b7258386868706632726957716a77545936716158346e3941414141414141414141414141414141414141414141414141414141414141414141414141414141414141422b35654b646447492f323862373855564c35764f37433462424932613374486974457a552b524e364545514141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141514141514141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414e6f386758735276585251345a77782b6c6546387671724d6647636d5533684265737a3077346572465a6b61367273532b34744551667077436a757269654e4c6142422f4f744e426a6a4a63392b30466838734e35227d19500a00000000000012d3063082034f30820237a00302010202021000300d06092a864886f70d01010b050030818a310b30090603550406130255533116301406035504070c0d53616e204672616e636973636f3113301106035504080c0a43616c69666f726e696131153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e473125302306035504030c1c546573742050656e756c74696d61746520417574686f7269747920313020170d3231303232323139323432315a180f32303731303232323139323432315a308185310b30090603550406130255533116301406035504070c0d53616e204672616e636973636f3113301106035504080c0a43616c69666f726e696131153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e473120301e06035504030c1754657374204c6561662043657274696669636174652031302a300506032b65700321000ac7b2b1db818b88c6d138f7aba211f9c17de3638e5648199586a51b50d458fea381b93081b630090603551d1304023000301106096086480186f8420101040403020430303106096086480186f842010d042416224f70656e53534c2047656e6572617465642054657374204365727469666963617465301d0603551d0e041604140e8780a9a304b7dfed747f8747bdf3e8df6376a2301f0603551d23041830168014c5d22030773ad70a6a31e0177ee31c67fb1aae5d300e0603551d0f0101ff0404030205e030130603551d25040c300a06082b06010505070304300d06092a864886f70d01010b050003820101001faae447a1ae9358071dce6086558e31db54d8a8f18b6b82e8e77bac1f0ee89d0b268bf9b350f627d773e389ccb7f4d398ec5bd9f054c94a521c0cdc43058e1ee97f8d228c229e6af26a12982d52cc66300b0b32f9c5b53ec71a2207ce585ddbe462c920f6e0fb3c94c74f4bf45aca0e6bfd34b4f4341fc3355129899424dd54991bafa63953e0732ace70407aedd37f6f03de228d6e65980621a52f924fd0c6cd0119dd77858e53588900fecfa61e720482601439df551d3b7fc245c8f4b586e5529dfcbf37204653e31be5e8f20db74400678a7fdb88ecc0eea6c4c28097a871744d171380d306cb0ea6fc751e576cce39a4eb864bcf476a0a7baa0d8914bf12f509308204f1308202d9a00302010202021000300d06092a864886f70d01010b0500308181310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d53616e204672616e636973636f31153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e47311c301a06035504030c135465737420526f6f7420417574686f726974793020170d3231303232323139323432315a180f32303731303232323139323432315a30818a310b30090603550406130255533116301406035504070c0d53616e204672616e636973636f3113301106035504080c0a43616c69666f726e696131153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e473125302306035504030c1c546573742050656e756c74696d61746520417574686f72697479203130820122300d06092a864886f70d01010105000382010f003082010a02820101009beec250ba1e7f1d6499cdbde2d68e93b104ab2d72a17224294f4e701fe4417ae877e89d35d041a6f1fc27369d395faa21203368c3ebb92ffeacb313b2232232a45e1d2523e0d714f74bac71b3ed3451ebcf02da9609bd9dded626073e92d1f6ec23e777aaeec1bdd283d9f61ccac8a14e284c95bfcfdbe58116d148190dbe62b269e389a202a83a035c40ad2486e294dd9973694a363a319608dec8ec52d6bd5691c38c7b176acee387e66a75ffd849e9f2882342606e46160c6a44787d61c7d8a05b88734c83655ea4b078124b1c889d2639c0db70ad1d5c2f9297559f4e12e220355a178b5eda40aa8ca3b2f2b916ddd2352e84bd6a2b83bb2578567bbd6b0203010001a3663064301d0603551d0e04160414c5d22030773ad70a6a31e0177ee31c67fb1aae5d301f0603551d23041830168014c21f83a0a3b6e83ee81114568d8cd134ef84113230120603551d130101ff040830060101ff020100300e0603551d0f0101ff040403020186300d06092a864886f70d01010b050003820201003c724814866b51e346bb68adce2f05896a3db4e8375506d03a1d95a606087708ca92a8a2398c26df971d91f9a1ab87540681c27c36994a6f34cc3340422bc349f0b59de68530d539d74ba2c5c416ad1471b3e74b9a99ce1c79aa905d3cb1d9be70036f5ddda11670563fb5ea8fd1f9cb5992c02fafdd1f550217315bdf0f8f4bd50011bc0be9735a035b6233676a1c0aee39439e72ef221ba7a0242e47a6ed328e4f5bab0baf12ca6d3fccf9d9fdf197a7e3ec58f18e6da0c70be387450ba8395da398fcbd995527a62196f2b2c3ce5e20a6cc0ac7025f6e17b92b017f12360f76860b783e27f82328f84babb3e623255b09f693973aac796fc478da8318108538783f9b0f9c306280d8702546be7ef85677f17a13e559b8acd62fd763cbdc50f2eb69cd1f0f3458b0cfebe3fc539c97252c6f0d83d8a4f8e7bef98d8734368aa64298ec4128d280077c984f21dd31e26c31ad965f719f75c0bc07cd51d2855d7c1805e73c24591b4f670698335c830e7d84f1f672dc2d45212046dee93328e37b01b3e6034a9917e77d83ba1d2f99a47824396903ee8cdf6d0e72ebc02fd912ecb6f34841b22039a1afa492a91dcae17413eee1bc9a1f84603d851b9b953492450619146e575d10deab1520d11c27e15f25bb573d0f2946e464cfb79e44d2dbb31f88bf2ef02b4a7e5c60974c76ab7ac601293ac18b4250e90685bdfdd9800012fb0b308205f7308203dfa00302010202145d7234090cbe808d54640f7fd82a974b3adf90df300d06092a864886f70d01010b0500308181310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d53616e204672616e636973636f31153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e47311c301a06035504030c135465737420526f6f7420417574686f726974793020170d3231303232323139323432305a180f32303731303232323139323432305a308181310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d53616e204672616e636973636f31153013060355040a0c0c54455354494e47204f4e4c593110300e060355040b0c0754455354494e47311c301a06035504030c135465737420526f6f7420417574686f7269747930820222300d06092a864886f70d01010105000382020f003082020a0282020100c853a8724bc211cf5370ed4dbec8947c5573bed0ec47ae14211454977b41336061f0a040f77dbf529f3a46d8095676ec971b940ab4c9642578760779840a3f9b3b893b2f65006c544e9c16586d33649769b7c1c94552d7efa081a56ad612dec932812676ebec091f2aed69123604f4888a125e04ff85f5a727c286664378581cf34c7ee13eb01cc4faf3308ed3c07a9415f98e5fbfe073e6c357967244e46ba6ebbe391d8154e6e4a1c80524b1a6733eca46e37bfdd62d75816988a79aac6bdb62a06b1237a8ff5e5c848d01bbff684248cf06d92f301623c893eb0fba0f3faee2d197ea57ac428f89d6c000f76d58d5aacc3d70204781aca45bc02b1456b454231d2f2ed4ca6614e5242c7d7af0fe61e9af6ecfa76674ffbc29b858091cbfb4011538f0e894ce45d21d7fac04ba2ff57e9ff6db21e2afd9468ad785c262ec59d4a1a801c5ec2f95fc107dc9cb5f7869d70aa84450b8c350c2fa48bddef20752a1e43676b246c7f59f8f1f4aee43c1a15f36f7a36a9ec708320ea42089991551f2656ec62ea38233946b85616ff182cf17cd227e596329b546ea04d13b053be4cf3338de777b50bc6eca7a6185cf7a5022bc9be3749b1bb43e10ecc88a0c580f2b7373138ee49c7bafd8be6a64048887230480b0c85a045255494e04a9a81646369ce7a10e08da6fae27333ec0c16c8a74d93779a9e055395078d0b07286f9930203010001a3633061301d0603551d0e04160414c21f83a0a3b6e83ee81114568d8cd134ef841132301f0603551d23041830168014c21f83a0a3b6e83ee81114568d8cd134ef841132300f0603551d130101ff040530030101ff300e0603551d0f0101ff040403020186300d06092a864886f70d01010b05000382020100818eb091ac31b10e66ae0f16def94939b46af53b06aae186f23d38cd5a5212678929147da2096b6b9ae08f8aacd465357bce9a7943f8d47622e114fe8b6d2b649244121b27c866a2e212f5dc75e95b13859ed5ea6171425db03e74e3fe0d4e1ff98d05f43eb2813ca3403fa715f7de2cde1fff2f9530f0289d4dd67b0aac4075f9bc23bab5ffcc0dd20eee8280cae1c6269882ac6104b9979af7c261646ee7a115188c83519f09ea63b1101eba71eb78c9094b9969ed5e5c5cad09f84e1a1b62f1494a86ef661731348d339307fef746fa9f000fb8bf75447186785aa658d16d19aaeaa6004ea362b52477bcd896594f62ea12360822cfa16d9082feb6ada16079aae3249a87fcb89332939eea5915bd967ee96a0d2e57d3768276546eb927d04f5fc45569d1bc3554caa0a61a5a648d9a6816e16886bc76db804830c959c0574094d287f8211d157775ead6f84dc6e2ca6017cea22449bc6f6fbb19f3f315e4fd9734f42f7c3bd31a809277303ece15baad308b2bc3738efaa78a5f215f8eb6e93f55471a15593ae93dfb69cabc1e4e49cf8be15b585d0e2ffc804f16a78bf7e1d0d4715e63fa686c911e57c5f6e4bc73703a27c55c9e3ccdb9bbe9273a50654f55e6298ad321e20f02a8dfc47c98541c60e7e311ab0e1b32fc4454fb270e1e9d36218da99d0c150691c23a36a529a2e00fe049f0ab85e3efa46153809be2a51a40dc98f56ad6675e8ed0c0fbe97703c3d7456ab4f0e0b126d160db1347297a2029ebc65d84b545dbe069e0a4c355db78d2b2f8d93c42b6ade31c9bf61d3e869a01";

  private static final String serializedNativeTxOut1 = "0a2d0a220a2096d8617e40ed91a2d64e178eaa094e368d79ba99e0e4635e8eb4b52ea0cacf2511c8a2790b6f52cbf212220a2026493f8f89fa0da368ebc1718106166e33ae6ca55c020533e2999dfdf17aa24a1a220a2044b37d84b3b3a9af320eb328ef7b60acc65853b13475ff473b94a75776ccad3522560a54c1c9517f91c2438631665223b7aa469e1d7842c22f8d86e9299c2b48311b178f6a3b0adbfe9c2e2f7c0c0db75685034b0d2df4c31f3ebf6f28c939ce0a28e0a379326579f5c52bfd62fe44e0071eb8da3f2d0100";
  private static final String serializedNativeTxOut2 = "0a2d0a220a20e22a66b7e47e9715347d09ab26397c11eda3d22f7fb828e7211f42736c413944114cb68f677ded938912220a20628237110e12505192eddfefdc060c7fc9141140496c7e278e7671dabb4bb6721a220a206ac207216beafa03309cf074fca62c6b502017a3b41767d77f12bf985b09d43222560a541089d113411fe5a0a5f56266d618612c918f1d5d3ffe197d4211e640ba920daa4d1bf4c253a7941ef0292791a0f00c88c6690188d9bdf6bff51ce2ca016ae37fda77d5d3034e3e97b9ae7ecb1add95be98850100";
  private static final String serializedNativeTxOut3 = "0a2d0a220a202ad7120b8bac67f269d090ed6f7b23c8ebe1882497dece3e6097d1797b83521a11516697eaaaa5762012220a20a6f85c13014065a652e5ca0de12d5aa189e301dd0dc6ffda37b281695e0dc4361a220a207eea0be44b3fb54146c7b7a5f89fc07b1862821cba6ee42b340eef8b9dcd262022560a549d79d119ead3528c760d6c1b453a5f85ed61ceb68d4527d902cfe2063c6745534b198a90b5799fab00bdc9227bfded05301fc60cdac33a603d0893ffbf9b982b923dc758b3379371b1f228573ee155b9f6320100";
  private static final String serializedNativeTxOut4 = "0a2d0a220a206e0a1edff5ed2a3b2d8c4c7a418e524f0cbdedccaf1374fefb3b4d67223ba12b1197d7f2108284494c12220a2088250ef3f7d506fedcec4eec9bdd8f10247667e69217568c4b135180a2f4b3711a220a2086eb856871f9d4277c6284309d9592da1dd14f7b8c35d30d48cd96d9fb91e17022560a54f3b46a165335a29a3c3806ed92757d0e81ee653f429bd11193e77b1847d7e4a366b9ae87909a0aaf5de9fbcf0aff18f298ea9b0afc88117de2aadbb681de38a3370c4ed3781621deb0c1394f7355e754302a0100";
  private static final String serializedNativeTxOut5 = "0a2d0a220a200825231e5c9d1b7fe6e1ec602d15d72b9bb03462fbf3e797cd683f755092f20f11dc06d083e587019b12220a20fc3fae5ecf0029ed73d2189caa82199dd6a263fd2bca26cd2a0ac2e4746ddc791a220a20ae59f48ace3c4eb73f60f1a962bb83a62ba882b2791aaa7619d57198093cde2c22560a54c865bbb6a89eb28634b083403cba4d4231e77206bab01b9afe289b7070418a589e577cd86995fef4365f7f648a2b048e6da75bef4e1179ba1274c3390c767c234a03c89b20963bea815523afa7500df580400100";
  private static final String serializedNativeTxOut6 = "0a2d0a220a2092aa8f077758c0f4346f5b128b71ef7dd21407a9ca5d43136a63bd0398d8000f112172f1fda13f2f5512220a20eab42a0db07d4c9e4baebd86b71b7faecab76bf16dff6f2029fc5b117ef75e0d1a220a203ae1c03502dfe5f6d58834d1e93b060b98c3540421be5ac68e552a30826c444b22560a54ce4d758bd182471eba2a92fca5a15b9bc1d61516c734b557c915370fbdd21d083cac8a7ad630ab63d597fe5de0464f253e732bf1ddc5a58e26151aa762d4b9031a4138f09dc7efd4e72bc7c5a262ec7e77390100";
  private static final String serializedNativeTxOut7 = "0a2d0a220a2042af8e64c71ae7fb29bfbdfe107cd88293625c6d0145571a202ed607d2ed9b2611813b54e044cd11fe12220a20dc6e76e87e27125feb4708f60aa79c825398b43dd571ecec61f409771d6162541a220a206231f0d580d4546004b7cf82893575f375707a2a1df5e022402ad699d35a1a3322560a5417c683fb2af376bc62ea0b397335d1b8201f272a0073f0bada33f8184cd2dfcfbd3a50eddccc60ffd6e3bae1cada9b23fd05ebb96624dea21d771df830c8161f610035f554d0cd7bc514efcc9f13baa038730100";
  private static final String serializedNativeTxOut8 = "0a2d0a220a20d2f2a49f98b6f49b0e9074d60412a69fab34a8c4c389786ddf273bd6301a27401105e55413873af7cf12220a20b6b8b818d17ee0f1e32dbc3299af994754861f0450f8f1997f914723601dab411a220a2038e3ab389e068893d06305733ce1111f375d2ccd7b17896ce97159b78846340f22560a544ee305d43a7a90abededbd21ceb87f12e2663aa1d42479fd5716f4d4e4b683dc01c25a5d9a7f06ba2cc1faf85b3ecd0972006bd00806f4ab1b5023edc7e1c8c7df3c29cb4ee99d291aea6c311a7247bcf5e00100";
  private static final String serializedNativeTxOut9 = "0a2d0a220a20d82b06b47f5835482c67bc080175f54b53886be49ec6107311cff99bff4e8d7011b81cbea5b5fe85c712220a20600928b148ede245d53c5c2026562802e66bc0125a102bb129250e5473c5e42d1a220a209245baa58fbb3baf03609ca24e1c3732093570e8ab397532b71cb91bb822213022560a540fc9655b23f2e8c061e7fbf500ebafb9a908cd37ee4adf9008f782c14e70cd6275eaa88623c10ac8b8a07b14628f385c50eb78b91d75aee9621891b2618c4b86d7353c2d008f18424cf344f4c00a02dd258d0100";
  private static final String serializedNativeTxOut10 = "0a2d0a220a20aea8f06399d460ef4cafeb4e4eb0fe93bc12e0320c25533b406d4a79939dab40113c7bb421799cc73112220a20a8d37db35397c3e5b953b3e06f47b47b3ac32b4c684a363bbd8fff71c95295451a220a2036a46fb9fc928cac35a7026b241db7c8e645a89f87020b7ddd495700546d6d5e22560a54000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
  private static final String serializedNativeTxOut11 = "0a2d0a220a205ece4b69357ff4fbe5adfd601b7ea1dbcf530cb2af44dde5a8173d12c0372a1a1150387efdd3039cb612220a2010b6452a0fdf538554603e319a6d1697e097876a3644214580b4b5977d1187251a220a20fca0d582fe031c3e6b0c7b3683de97a16db2ebb5dacd105864a42fab4969d16822560a54ed3c1ae11cebd9d6b4a8c85d8e979122fec6fdec595f247ffced4e10337d0c777864be7f7780774c7d72f527913bd3288a7eff17f7853e0ea2cdad5f7568acd57a2d86a6f41c73ed3597d3e01e7cf5bbe8780100";

  private static final String serializedTxOutMembershipProof1 = "0891c80410dd92071a2e0a080891c8041091c80412220a20342090a03d097d208f84a4e9aa8c204e4e77657be474079e8b26287bc8d6b4771a2e0a080890c8041090c80412220a20930d6557d1f75e7c538733127d191e546c8f7e8bff73aaabc6c2b1e1dc553fdd1a2e0a080892c8041093c80412220a2012b10cb942eebaa5a54e14561fdd90eed3e395579be591e3ee551f0fb5a4473b1a2e0a080894c8041097c80412220a203d5318f431fe66c1650ae269789071ea1da5a22746a5939b9f787f369be607d71a2e0a080898c804109fc80412220a206f8638e671b3c1e627fd01f76d2e1ed6da4c282398052ff29b9d1e8f77b2d2e11a2e0a080880c804108fc80412220a2060439407688f940ba3685fb8b6208f3b7b6b4a06ebb1f331c676f90405d4c6991a2e0a0808a0c80410bfc80412220a2023869cafe41f02b2a0516593bf95a03065bf20061d43e86912276e5130bc92851a2e0a0808c0c80410ffc80412220a20d454d0bab31d8ff5787b9c975564d98dee7a939c0491066524fff80b2b7017c31a2e0a080880c90410ffc90412220a20b94f4ad9f3a32b645e1d5fe73861a5444b7ac429653d6bd05a3d6a5971e409de1a2e0a080880ca0410ffcb0412220a2058727797e7e952185c1adc883d78c741a365d955d6dae0c83083f89dac89feb41a2e0a080880cc0410ffcf0412220a2051b8533354f723e1bc507f5ffbbf07a5a6b7d16b35931c09c27288faf62dcb6c1a2e0a080880c00410ffc70412220a2057c7bdb5e275eae55c464e2b65add03e4997cdeb85c9b2016ef9e30a00e5e08b1a2e0a080880d00410ffdf0412220a206496553ab8b10d19a1c9ca93934083dc7888db1f9c28460d293fe7ad141ca6b31a2e0a080880e00410ffff0412220a202be341f625bdb58ccca2ba3fdb98f718f99bff55ca14e67f10d8f849468984fe1a2e0a080880800410ffbf0412220a20e78b4b25e9c22ec0bb478442ad4f73c939d9cf66c973bb52a8c90f0db75594e81a2e0a080880800510ffff0512220a20fb10a890567ac36a45711d93a228c71b87226eab98637d4bf1f73bf1e5d59cf31a2e0a080880800610ffff0712220a2038ca2874b3d707f997b0dacb7197b4599f6e9d814f321c63ec517546acd8c6491a2a0a0410ffff0312220a20f29e5b08a3161a7700a5492b35abb947598921aaf36c56e23b0babff445db6dd";
  private static final String serializedTxOutMembershipProof2 = "08a2a00310dd92071a2e0a0808a2a00310a2a00312220a20a6e29bcfeab30fea367180c353a47b05777aeb86ce8ae760527d27c1033ef9b41a2e0a0808a3a00310a3a00312220a203a44329310d0f603f50f3a672fb05e606554e66ad8609200b8ae92f7ebf57d551a2e0a0808a0a00310a1a00312220a20276c7018d07652317be860d67459a7275c0b78aac99b7d4883d7625d77ec2fa31a2e0a0808a4a00310a7a00312220a20cac482137a023f5d95f078cc65d5fd31cf5f6e57fee1f2dedef92de76bce3ba51a2e0a0808a8a00310afa00312220a20422317ed8cdd887b414718fe1740b6b8fbe942db38f2bf3cb84c48284d7240431a2e0a0808b0a00310bfa00312220a2064ed8cac0d47d137c4bbff12e4703d958f5d13858d328108d68e229a94d2a32b1a2e0a080880a003109fa00312220a2041d15e99e90ed28f2ed1cb8aa931e2c7d2b9329a5a8d006708a2410f446d56961a2e0a0808c0a00310ffa00312220a202bed37a071fccb2677726e441a14bd5d962d2dd49688febda73bdd95f24e05ea1a2e0a080880a10310ffa10312220a20e9476f997a4394113ba0dd7e1d8704033b11ded04fbb42f3cb870fd345b6e86d1a2e0a080880a20310ffa30312220a20bfd492553556c747c92129ea8672dad083025529f4f6b34dbf373844dbcad88a1a2e0a080880a40310ffa70312220a207bc012647e80bb0a1f59ef66bbbca0504e826907d28753be8f2d6c56aa1241441a2e0a080880a80310ffaf0312220a20697042df2f1d90161ea7c6a179d89bd72182d43c65eae21e939e863de03d2c871a2e0a080880b00310ffbf0312220a20b56c95fea6370cc8b78c0783c18753a4264832fc01c01d1fbdf1dca3163986da1a2e0a080880800310ff9f0312220a205bb4563096546f8aa963fbeeaf79f85ddb0850a3b97c548439306213d0228af71a2e0a080880c00310ffff0312220a2094c72d9b36eb5afab77ad8075d499fb0bf9a1508df6f5f02d6b8f9c946b913fd1a2e0a080880800210ffff0212220a202b88523370fb8d1ddbe7a18562e0914bea026092074dc1faca3ce8e28e0a5b6a1a2a0a0410ffff0112220a204ff926b8f4ccfffd186407587131f5354750594efcbf1bfc69e9dfc390f94e0d1a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof3 = "08946010dd92071a2c0a0608946010946012220a2037f24f838512471b1b6cf42c7f01bddb0bfce1677751eebcebba4072c15ea5881a2c0a0608956010956012220a20479492ad406f27908dad955cc8ea03a1aa7bcda64561e5c141957ee9e4b590ed1a2c0a0608966010976012220a202c47ccf0611b531a40b63058f3ab735ca320034400a6e9de9d1bfce270673c541a2c0a0608906010936012220a208d371569cd3a829ab91e71be791f8036e3600426ded5b2ab60c4e0f1f5054cbc1a2c0a06089860109f6012220a206cfd10a256178d5a6babe6abe1f028d8bb27a153a7eb9d743352446d4edc53181a2c0a06088060108f6012220a20bf92cd994cf204f5ed76007097df5d2636f75109ae1847d3d462cfd1b20b07c41a2c0a0608a06010bf6012220a203365192a568e60cf9b406c32a5d356e3b19d8e84b90c301754c59903b890101a1a2c0a0608c06010ff6012220a20eb9ed9eb64f29803b395cb563a4f58e37032388d6a85e9a9055f8d297d11db941a2c0a0608806110ff6112220a20d5c1b01b1c48abf882718f8868f2cdd011318062d0138b2e61db458fb2817df21a2c0a0608806210ff6312220a204b609628e558f735e2e61208d5bbe9ea873dcafc6bea9bffcf495c93367b777d1a2c0a0608806410ff6712220a2019456c27c3c60e84201ff8a905bc750154dec2bff6b28dd03a83a80687a34a941a2c0a0608806810ff6f12220a200754396a7c7481a89a095832ae14a3237f245b9ed37c5aee2f413e0db2683dde1a2c0a0608807010ff7f12220a202041ef2f700d23fa7bcdcf35895e009b56506161e33ff26f8c603dbecbf43ae21a2c0a0608804010ff5f12220a20fc2a224473323446c43e83bd31e4973f44e8b71c30125756ea19f240a01f66cc1a290a0310ff3f12220a2015c884410720e0b619cd604e9204393f508280597140fce5840320a91205b1d71a2e0a080880800110ffff0112220a20f5c9a4424c4859b7a3695da5e7f8318b0826810d16b15e596bb61eae7fa4dc271a2e0a080880800210ffff0312220a20fb60de8b02816991ec85920326ce47b3bb2ce6d4204c680cab1fcc5e36d74d411a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof4 = "08b3910710dd92071a2e0a0808b3910710b3910712220a20ca1f295d4e1a807fcea55edbc69c7a71cfeda23300e4b1c59e767b534e5dbd5a1a2e0a0808b2910710b2910712220a20a15714b8bfa0f24d623ac29047b849a2019fa32a21fb667ad55df3036ba2ead21a2e0a0808b0910710b1910712220a20c6d1167781a3cf718db198ce22f57f5860c6fe0e00f0a3e4152ed358c719f5ce1a2e0a0808b4910710b7910712220a20dd7fb83f8f570f14a5ba5ffb12cc46553b16eef5263909d99942b780bbb86e1e1a2e0a0808b8910710bf910712220a205d31e770650feee6b9ebb8f0a42dccbc0e6068df5df2d73feb3a01ea213777651a2e0a0808a0910710af910712220a200f3a56e63882d1765bae59aec3e87913f4aaba423c3d874c6b9554e657fc55761a2e0a0808809107109f910712220a2010929b194f880c2a397f99b9e6bdc625b1d48de2b32abf608f09840e25627eaf1a2e0a0808c0910710ff910712220a20d1d23db257da96d5c2d2d311d1ab072882a5bbd41fb6b4792d7c7b5d4f95ae421a2e0a080880900710ff900712220a20dcf1ae2599b68a9b74c881b5d33679f61aebd2dacf463224c202c20cd07ffef71a2e0a080880920710ff930712220a20e8a3a1a345239a8b8e685fa2d8054c975de0487a008bfd635f3ecb544818f4d31a2e0a080880940710ff970712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880980710ff9f0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880800710ff8f0712220a20cef4b3f674d95ad1c2cad0124c9ba2a45f91ca14174b6e6f29f4b743761a07d11a2e0a080880a00710ffbf0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880c00710ffff0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880800610ffff0612220a202337187195b751a8fc398fddaf0256ba08bd18248cfd098a092b641be4712f361a2e0a080880800410ffff0512220a20797b94d21cbdc8de0c9d1cb1a973f1342bd95dc9e5a19b105e705b863d60437a1a2a0a0410ffff0312220a20f29e5b08a3161a7700a5492b35abb947598921aaf36c56e23b0babff445db6dd";
  private static final String serializedTxOutMembershipProof5 = "08b65f10dd92071a2c0a0608b65f10b65f12220a2048338e100d2ca1ad585ab64243e84bbb39db29e4da6bf3c2a669127c689f93e51a2c0a0608b75f10b75f12220a2037b38fd43d59003db7bfc1b3284e53766f194634917e633c2a72de4113a42fd31a2c0a0608b45f10b55f12220a20b8eca2e5a8b737e9379189bd7650bedef7dab7757ee2bbb7a5b549e378fd51e41a2c0a0608b05f10b35f12220a20f28e7da8b19c8899a75bc8c25641ae9793dfb09552537d0a13920924524534081a2c0a0608b85f10bf5f12220a205ea798febd32eb6fb2553e5d3e141fee557a2a72d19e8cc956019a28cabf73211a2c0a0608a05f10af5f12220a2061eaa69cdfd775f326ff44d4503f3d836181aefa30215c93418c2482261743511a2c0a0608805f109f5f12220a204e19b143264a8e4155a3f7b95d2367dee50ad1427f3bd1b928206ee2a4bdb2bb1a2c0a0608c05f10ff5f12220a2005c2fd8d82918205bbdcda92e5d7eea9bcae3c4cbb2785361271591ed201928f1a2c0a0608805e10ff5e12220a203e1ea486ea183bf2fe00ad65e38be86e48ef4fc9ba56233a906981b5d897f19c1a2c0a0608805c10ff5d12220a20973212a05a13fdb0e23fdccc10140a155f0ec386655957890af8d006df15acd31a2c0a0608805810ff5b12220a20941f43b5a65b38d35a5bc679abffd91cf263ac760373e18e645f287971763d5b1a2c0a0608805010ff5712220a20a3475c528ebed6927f7569aa3a625dad7b9019c853eeb1a6cab854e3a27aab231a2c0a0608804010ff4f12220a204db9310368010d0efb40df8c9d0301cc0b3557aaabc4b24956e2d1c9e48d75911a2c0a0608806010ff7f12220a201c00a16693245619a4293a9902497c45e79055240cbb184fbb9fc1b32dd94f2b1a290a0310ff3f12220a2015c884410720e0b619cd604e9204393f508280597140fce5840320a91205b1d71a2e0a080880800110ffff0112220a20f5c9a4424c4859b7a3695da5e7f8318b0826810d16b15e596bb61eae7fa4dc271a2e0a080880800210ffff0312220a20fb60de8b02816991ec85920326ce47b3bb2ce6d4204c680cab1fcc5e36d74d411a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof6 = "08dcef0510dd92071a2e0a0808dcef0510dcef0512220a20f09cb23832b6b9b47cbbea761085f9d03ef2c87865b2294b2a484239976565c81a2e0a0808ddef0510ddef0512220a203fa149505fe7d57773a0dffad82194e50038977e69acab0de14237f3813144181a2e0a0808deef0510dfef0512220a200a3dfa3c38eb4cd273ffa95a3e73a192fd2ffd6a640b7c3a570bc12bb57a2d491a2e0a0808d8ef0510dbef0512220a20bd0c845ad62cc61d42bc19396b08723abfb2f55ca916b3987d006b0b33e6b38e1a2e0a0808d0ef0510d7ef0512220a20f7bf0fbefaef83edbbc0f1fbf3e1dc2c9f841ede1c9e89ce75a59afbffe9238d1a2e0a0808c0ef0510cfef0512220a20fc93da0625c1c0f8cd1f90dd4017ed8d3b5cbdb3f12aa16ca1b6ed8a64ab6a271a2e0a0808e0ef0510ffef0512220a20eb7ff8b69a6a0cbe59d793abbd880f46411ebffb0190081dbd42f2300798b7e31a2e0a080880ef0510bfef0512220a2083acb252bc044304cf79370e03ced49dcc70c1fb1d2b80ecbbaab41eedcdf4d41a2e0a080880ee0510ffee0512220a209693aae6cba5a92b0144a2b3cc5b24bdaa5d8e2da64a9bfae2e56dc61db40a4d1a2e0a080880ec0510ffed0512220a20d805d93341f16ebd4bbe93bfa75956fa72dd05ebe7917bfae17157e1c3853c301a2e0a080880e80510ffeb0512220a2048a51458936d6549f7ec8dc4dd3584904e667b546bea8143163a95d78c79dcc11a2e0a080880e00510ffe70512220a2025313bb5cdc53dd875c76acdd1ee94b6f2dff264b1b7fcbf0e08197c5fa5511c1a2e0a080880f00510ffff0512220a204499b229ac7485ae47fa9837dd46a98ebb6ca9a9935235fcc79c3ba259e695f01a2e0a080880c00510ffdf0512220a20ce2de778c0cb51f01d5721250d57f69a2b6e4cc17566b078b84741a5c0a053f51a2e0a080880800510ffbf0512220a20bdc27982150e27a5e78d995784a239f187a65f3fc1f673d793ce2f3fa828d5ac1a2e0a080880800410ffff0412220a202385ccb3b4d6356701b1b6d8931d97ff23131fc11195b3106e6a7f59065d28061a2e0a080880800610ffff0712220a2038ca2874b3d707f997b0dacb7197b4599f6e9d814f321c63ec517546acd8c6491a2a0a0410ffff0312220a20f29e5b08a3161a7700a5492b35abb947598921aaf36c56e23b0babff445db6dd";
  private static final String serializedTxOutMembershipProof7 = "08fc940210dd92071a2e0a0808fc940210fc940212220a20cdb83799349c7b086ddd82f3389cf7288f3dc2e8fab4c48445c41651906661bd1a2e0a0808fd940210fd940212220a206aca12fbe8ee0be3c21df6e8d197a7a3f922a7f90bf2d4456e58030d85feda941a2e0a0808fe940210ff940212220a2090b7c87af0b0d3701bf262190ca9343712b8cc92506e54b13001b9e46e45b9f31a2e0a0808f8940210fb940212220a201fb0e98997046ce95ff8d659cc551269f0805e56f3f02638c377479df02091841a2e0a0808f0940210f7940212220a202554e95b10dc5a30d2f037c378a669f00d68c7284bc9dbff4c9b375a539ca4d41a2e0a0808e0940210ef940212220a207da596187054e08c2ce018cf7b708f9d3c0bcae4665847038eeab119a8325bb51a2e0a0808c0940210df940212220a200e3875bd45b50a52ccf68a72f7d833128c09853d3ee14b3ddad93b9eca2e2a631a2e0a080880940210bf940212220a20019fe19bcfebb380de5247b2e9d1ad28f485433f53356fb8baff36f907232c9e1a2e0a080880950210ff950212220a2048649b8b25e4a8deb004e7c3edb26e0237597b398ed7c791c3e76affb991e89c1a2e0a080880960210ff970212220a20b5e901a7d12988c8ce7b557124d223cd8109bfa2f70533d952019c65eba4f62b1a2e0a080880900210ff930212220a2010489abbf419eea6a5ca15c25bf9c30cfaa2317ca7e584a987baa7444df48caa1a2e0a080880980210ff9f0212220a2097cf3f7c3f1d61c210d278824c585dbcf992b73c8b0b5e271f39b58c75c9bd571a2e0a080880800210ff8f0212220a20d28063b31543f375c23bc17be23ed19291e180d196a6c86a7389aa6f94faa7dc1a2e0a080880a00210ffbf0212220a2044a2c2b59232cac82ee6de810b6a6775d8743a5e7630975520b45abd6b127cdd1a2e0a080880c00210ffff0212220a208aa118e729a4c8b63db46cdbee74b6cbc019cadec3101bb726f95fc5fa2db4c81a2e0a080880800310ffff0312220a2073fdace37f7d64fca60ac0827df3c72f0c44f9d4afbd1d6df52e4300546362c51a2a0a0410ffff0112220a204ff926b8f4ccfffd186407587131f5354750594efcbf1bfc69e9dfc390f94e0d1a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof8 = "08ed960210dd92071a2e0a0808ed960210ed960212220a203513b1f1b52d78be9961ec379e6a373aa282190b93c5f5ea0959fb54424cb76f1a2e0a0808ec960210ec960212220a200f6ecd03398e3964dcceb4211da2eaae1f154211a26f7eb65dcea0a09fa9b84d1a2e0a0808ee960210ef960212220a201e68e84127856a51d09984487ce9a3906b53c2177c67f8357f65e2923855f1d01a2e0a0808e8960210eb960212220a20fdae18d48da01489e5923eff1352c3cbbe94aa0bd60294f86514e3b19bf584da1a2e0a0808e0960210e7960212220a204a39243c85737764078f930706b0406b0a935f6a88bf6241dbb5a822fe83edb71a2e0a0808f0960210ff960212220a202092859f230537fe11479a5d54ff9b84d683fc1fb109e9dc1e3bc2b843e8c8fd1a2e0a0808c0960210df960212220a20a508e859ebb94a706bf6f5b5ae929a9bd6c143df0500364f6d2022c65376e4401a2e0a080880960210bf960212220a2014e96138f4edb0a7e93c3187d355050476a98afdd6d94149faacbeb7ed869da41a2e0a080880970210ff970212220a20518c1df46f5c646579e4e9157db9be5f78dbe15c5c3f70cd45224ad9b0272dae1a2e0a080880940210ff950212220a20864738a96acf652306763efa28f2aff94b8c13e55bddb84bfc4e4672b0f0b2251a2e0a080880900210ff930212220a2010489abbf419eea6a5ca15c25bf9c30cfaa2317ca7e584a987baa7444df48caa1a2e0a080880980210ff9f0212220a2097cf3f7c3f1d61c210d278824c585dbcf992b73c8b0b5e271f39b58c75c9bd571a2e0a080880800210ff8f0212220a20d28063b31543f375c23bc17be23ed19291e180d196a6c86a7389aa6f94faa7dc1a2e0a080880a00210ffbf0212220a2044a2c2b59232cac82ee6de810b6a6775d8743a5e7630975520b45abd6b127cdd1a2e0a080880c00210ffff0212220a208aa118e729a4c8b63db46cdbee74b6cbc019cadec3101bb726f95fc5fa2db4c81a2e0a080880800310ffff0312220a2073fdace37f7d64fca60ac0827df3c72f0c44f9d4afbd1d6df52e4300546362c51a2a0a0410ffff0112220a204ff926b8f4ccfffd186407587131f5354750594efcbf1bfc69e9dfc390f94e0d1a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof9 = "08ceaa0210dd92071a2e0a0808ceaa0210ceaa0212220a209152ef0ab2e2fd35d070e5c1ac3943029ebd32e8fb4d6e112e083b7018382ad81a2e0a0808cfaa0210cfaa0212220a20fa1f8d499ccb75559873ad67d1c00659ffff74b2b2158c828a3be0084210a05e1a2e0a0808ccaa0210cdaa0212220a20789ce65fe150a86483103c9b425ec0a794a1d944b3404380069142cfe3a007ce1a2e0a0808c8aa0210cbaa0212220a2080f70456ed4de5ef26b0ec6c2504b18898b6bea8a70a208577960c6e8def08201a2e0a0808c0aa0210c7aa0212220a203fea823651c7f4a3e59467abcdf618460fb0773e74e33eb280816129402cbd441a2e0a0808d0aa0210dfaa0212220a20274ec988ab9055b78974540224ea9e181370c0775d3a4a8bdaa48ec10ab4d0591a2e0a0808e0aa0210ffaa0212220a2065984c011833f2bd254dd12435abcd9a5216fb7a659fcd5a1a39353e7d7a8b391a2e0a080880aa0210bfaa0212220a20b194ad8f41b18102e83f8f3062041bfe9a5188968ceeacff8a1d5f3e4cdf643f1a2e0a080880ab0210ffab0212220a209e9791b1d217ce942e46c946de0406fa21ac7ed827fbe3e7a6d62b2c33c9850f1a2e0a080880a80210ffa90212220a20e845352f785995bc99f59ad4c85ec032ce50c8fe640623e3591d7d64598f89a01a2e0a080880ac0210ffaf0212220a20f6d4a5ea4324c11f3be45e156405d43c065c8998779a9ca93975252c9b2c976d1a2e0a080880a00210ffa70212220a2035b79cf78db284dc563b8f69508279f41187b2208d2225b12c61970ee83432d11a2e0a080880b00210ffbf0212220a2092a9cad4226655f46141112558dc870fcebbc06428ed15c051738592411480bc1a2e0a080880800210ff9f0212220a2029bf76ab8d3e04f4ffe5b8ba7bf6fd84d4ed06e0ee4a0934fac8f959f731dc321a2e0a080880c00210ffff0212220a208aa118e729a4c8b63db46cdbee74b6cbc019cadec3101bb726f95fc5fa2db4c81a2e0a080880800310ffff0312220a2073fdace37f7d64fca60ac0827df3c72f0c44f9d4afbd1d6df52e4300546362c51a2a0a0410ffff0112220a204ff926b8f4ccfffd186407587131f5354750594efcbf1bfc69e9dfc390f94e0d1a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";
  private static final String serializedTxOutMembershipProof10 = "089f910710dd92071a2e0a08089f9107109f910712220a2062134c4652687380e98dfeb948f5357100c1c21e4e7537991f3ca89d4695b8421a2e0a08089e9107109e910712220a20f56526a0899bdeb7f94eb4ad3c7cd69d5d0469d5202f199f3d3f87b0864724381a2e0a08089c9107109d910712220a20073fcc11b99c7a24e1181799a9c78d589c2af44b102efc2f0019110e9d3da43d1a2e0a0808989107109b910712220a2054559b14706be7097d245230ed941e568e50af22bda17e8aadaada6bd6bebaf91a2e0a08089091071097910712220a20bb683dcc339278bf2ae395cc09e8200249f07388a74dee4c6a0011e4ccb1c1d31a2e0a0808809107108f910712220a20fd91765d51a36334cef29259a567dc047998d5ee4cb42045ba291bf1833bdb6c1a2e0a0808a0910710bf910712220a200699a58446df1f4bf82c42c9f4d20659ee9b41bbc39a98bd6a6a54799488a3bd1a2e0a0808c0910710ff910712220a20d1d23db257da96d5c2d2d311d1ab072882a5bbd41fb6b4792d7c7b5d4f95ae421a2e0a080880900710ff900712220a20dcf1ae2599b68a9b74c881b5d33679f61aebd2dacf463224c202c20cd07ffef71a2e0a080880920710ff930712220a20e8a3a1a345239a8b8e685fa2d8054c975de0487a008bfd635f3ecb544818f4d31a2e0a080880940710ff970712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880980710ff9f0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880800710ff8f0712220a20cef4b3f674d95ad1c2cad0124c9ba2a45f91ca14174b6e6f29f4b743761a07d11a2e0a080880a00710ffbf0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880c00710ffff0712220a20ffdaaf4305e365c4c30ca1e5fbf4f5e62b081441ee94eb2d0980470b5e7059681a2e0a080880800610ffff0612220a202337187195b751a8fc398fddaf0256ba08bd18248cfd098a092b641be4712f361a2e0a080880800410ffff0512220a20797b94d21cbdc8de0c9d1cb1a973f1342bd95dc9e5a19b105e705b863d60437a1a2a0a0410ffff0312220a20f29e5b08a3161a7700a5492b35abb947598921aaf36c56e23b0babff445db6dd";
  private static final String serializedTxOutMembershipProof11 = "08f0cd0310dd92071a2e0a0808f0cd0310f0cd0312220a208ae4a64361aea79f5ef64fa43575f489b16bb198e63cdf7dd4be10837f3933631a2e0a0808f1cd0310f1cd0312220a20c5efab16e94531a6a37fc3dc9cc808537218087731929597e93e1c6a753b21dd1a2e0a0808f2cd0310f3cd0312220a200bf02c38be3008f8c8cc01c31e1feba2890a32e33e6f832800cc199a5885f0201a2e0a0808f4cd0310f7cd0312220a200a998532ebaf370aa83737983ea42d5817bbacb3dbf971eaa3c92bd4d93e14971a2e0a0808f8cd0310ffcd0312220a2076505a06be094f544c6a68752e00b7db79bc04ec6c803be8eb49a6a3657ab9671a2e0a0808e0cd0310efcd0312220a207654bff3dc2a119df898ae90749946d72eb9c2fc9a3824a03509a10de69dbba41a2e0a0808c0cd0310dfcd0312220a2060f94e66ff2fb4e18d7b9be16a1f6f2d191c8715d4130c43f3001eb05ef966661a2e0a080880cd0310bfcd0312220a20fbe301dd787a9196a5f7d50c480dc2bf3775426ae81ea7bc0e86c24c91602b111a2e0a080880cc0310ffcc0312220a20d42fbc7d0f71d61cad2dd088199c2b9b4cc20851cb8bab77870d56235c37e12f1a2e0a080880ce0310ffcf0312220a207d47a1ac6ce04927e96de85392c1876c23ccd6141826d63fd8fec596a2ce6dd41a2e0a080880c80310ffcb0312220a2036464b49a3aa6c63b924dc2cb5337398e27ca21c46ed16935d38dceaddef96871a2e0a080880c00310ffc70312220a20edd7e2d3eb8db1690ec7e8d76c55db0a35a72cf6b48c61864e01ec2d4619b8641a2e0a080880d00310ffdf0312220a20658db5d6688b025414ff246af052df1aefe0477c0ca0089fd0f508db7e49b9c71a2e0a080880e00310ffff0312220a20f8d60438a513951868fbfd6142b03b852ba91ffd2b9ecb6041966cfb724bd2bf1a2e0a080880800310ffbf0312220a208f0bc275db1424f3353b03e7a465cb62a8784b083fc75c792b9093cbad9234801a2e0a080880800210ffff0212220a202b88523370fb8d1ddbe7a18562e0914bea026092074dc1faca3ce8e28e0a5b6a1a2a0a0410ffff0112220a204ff926b8f4ccfffd186407587131f5354750594efcbf1bfc69e9dfc390f94e0d1a2e0a080880800410ffff0712220a202dda655a09b0a61d89e4c320674b6bea439d1cc7324cb5fca91a9479bf2e6756";

  private static final int MEMO_BLOCK_VERSION = 1;

  // The 'real index' corresponds to the index of the TxOut in a Ring's TxOUt list that actually
  // belongs ot the spender and is being used in the transaction.
  private static final short realIndex = 3;

  private FogResolver fogResolver;
  private AccountKey senderAccountKey;
  private AccountKey recipientAccountKey;
  private TransactionBuilder transactionBuilder;

  private List<TxOut> txOuts;
  private List<TxOutMembershipProof> txOutMembershipProofs;

  @Before
  public void setUp() throws Exception {
    fogResolver = createFogResolver();
    senderAccountKey = AccountKey.fromBytes(Hex.toByteArray(senderAccountKeyHexBytes));
    recipientAccountKey = AccountKey.fromBytes(Hex.toByteArray(recipientAccountKeyHexBytes));
    txOuts = createTxOutList();
    txOutMembershipProofs = createTxOutMembershipProofs();
  }

  @Test
  public void buildTransaction_senderAndDestinationMemoBuilder_buildsCorrectSenderMemo() throws Exception {
    TxOutMemoBuilder txOutMemoBuilder = TxOutMemoBuilder
        .createSenderAndDestinationRTHMemoBuilder(senderAccountKey);
    TxOut realTxOut = txOuts.get(realIndex);
    transactionBuilder = new TransactionBuilder(fogResolver, txOutMemoBuilder, MEMO_BLOCK_VERSION);

    RistrettoPrivate onetimePrivateKey = Util.recoverOnetimePrivateKey(
        realTxOut.getPubKey(),
        realTxOut.getTargetKey(),
        senderAccountKey
    );
    transactionBuilder
        .addInput(txOuts, txOutMembershipProofs, realIndex, onetimePrivateKey,
            senderAccountKey.getViewKey());
    long fee = 1L;
    transactionBuilder.setFee(fee);
    transactionBuilder.setTombstoneBlockIndex(UnsignedLong.valueOf(2000));
    BigInteger sentTxOutValue = BigInteger.ONE;

    transactionBuilder.addOutput(sentTxOutValue, recipientAccountKey.getPublicAddress(), null);
    BigInteger realTxOutValue = realTxOut.getAmount()
        .unmaskAmount(senderAccountKey.getViewKey(), realTxOut.getPubKey());
    BigInteger changeValue = realTxOutValue.subtract(BigInteger.valueOf(fee))
        .subtract(sentTxOutValue);
    transactionBuilder.addChangeOutput(changeValue, senderAccountKey, null);
    Transaction transaction = transactionBuilder.build();

    List<MobileCoinAPI.TxOut> outputsList = transaction.toProtoBufObject().getPrefix()
        .getOutputsList();
    TxOut txOut1 = TxOut.fromProtoBufObject(outputsList.get(0));
    TxOut txOut2 = TxOut.fromProtoBufObject(outputsList.get(1));

    TxOut sentTxOut;
    try {
      txOut1.getAmount().unmaskAmount(recipientAccountKey.getViewKey(), txOut1.getPubKey());
      sentTxOut = txOut1;
    } catch(Exception e) {
      sentTxOut = txOut2;
    }

    byte[] sentMemoPayload = sentTxOut.decryptMemoPayload(recipientAccountKey);

    AddressHash senderAddressHash = senderAccountKey.getPublicAddress().calculateAddressHash();
    SenderMemo senderMemo = (SenderMemo) TxOutMemoParser
        .parseTxOutMemo(sentMemoPayload, recipientAccountKey, sentTxOut);
    assertEquals(senderAddressHash, senderMemo.getUnvalidatedAddressHash());
    SenderMemoData senderMemoData = senderMemo
        .getSenderMemoData(senderAccountKey.getPublicAddress(), recipientAccountKey.getDefaultSubAddressViewKey());

    assertEquals(senderAddressHash, senderMemoData.getAddressHash());
  }

  @Test
  public void buildTransaction_senderAndDestinationMemoBuilder_buildsCorrectDestinationMemo() throws Exception {
    TxOutMemoBuilder txOutMemoBuilder = TxOutMemoBuilder
        .createSenderAndDestinationRTHMemoBuilder(senderAccountKey);
    transactionBuilder = new TransactionBuilder(fogResolver, txOutMemoBuilder, MEMO_BLOCK_VERSION);

    TxOut realTxOut = txOuts.get(realIndex);

    RistrettoPrivate onetimePrivateKey = Util.recoverOnetimePrivateKey(
        realTxOut.getPubKey(),
        realTxOut.getTargetKey(),
        senderAccountKey
    );

    transactionBuilder
        .addInput(txOuts, txOutMembershipProofs, realIndex, onetimePrivateKey,
            senderAccountKey.getViewKey());
    long fee = 1L;
    transactionBuilder.setFee(fee);
    transactionBuilder.setTombstoneBlockIndex(UnsignedLong.valueOf(2000));
    BigInteger txValue = BigInteger.ONE;

    transactionBuilder.addOutput(txValue, recipientAccountKey.getPublicAddress(), null);
    BigInteger realTxOutValue = realTxOut.getAmount()
        .unmaskAmount(senderAccountKey.getViewKey(), realTxOut.getPubKey());
    BigInteger changeValue = realTxOutValue.subtract(BigInteger.valueOf(fee)).subtract(txValue);
    transactionBuilder.addChangeOutput(changeValue, senderAccountKey, null);
    Transaction transaction = transactionBuilder.build();

    List<MobileCoinAPI.TxOut> outputsList = transaction.toProtoBufObject().getPrefix()
        .getOutputsList();
    TxOut txOut1 = TxOut.fromProtoBufObject(outputsList.get(0));
    TxOut txOut2 = TxOut.fromProtoBufObject(outputsList.get(1));

    TxOut changeTxOut;
    try {
      txOut1.getAmount()
          .unmaskAmount(senderAccountKey.getViewKey(), txOut1.getPubKey());
      changeTxOut = txOut1;
    } catch(Exception e) {
      changeTxOut = txOut2;
    }
    byte[] changeMemoPayload = changeTxOut.decryptMemoPayload(senderAccountKey);

    DestinationMemo destinationMemo = (DestinationMemo) TxOutMemoParser
        .parseTxOutMemo(changeMemoPayload, senderAccountKey, changeTxOut);
    DestinationMemoData destinationMemoData = destinationMemo.getDestinationMemoData();
    UnsignedLong totalOutlay = UnsignedLong.valueOf(fee).add(UnsignedLong.valueOf(txValue));

    assertEquals(UnsignedLong.valueOf(fee), destinationMemoData.getFee());
    assertEquals(totalOutlay, destinationMemoData.getTotalOutlay());
    AddressHash recipientAddressHash = recipientAccountKey.getPublicAddress()
        .calculateAddressHash();
    assertEquals(recipientAddressHash, destinationMemoData.getAddressHash());
  }

  @Test
  public void buildTransaction_senderWithPaymentRequestAndDestinationMemoBuilder_buildsCorrectSenderWithPaymentRequestMemo() throws Exception {
    UnsignedLong paymentRequestId = UnsignedLong.valueOf(301);
    TxOutMemoBuilder txOutMemoBuilder = TxOutMemoBuilder
        .createSenderPaymentRequestAndDestinationRTHMemoBuilder(senderAccountKey, paymentRequestId);
    TxOut realTxOut = txOuts.get(realIndex);
    transactionBuilder = new TransactionBuilder(fogResolver, txOutMemoBuilder, MEMO_BLOCK_VERSION);

    RistrettoPrivate onetimePrivateKey = Util.recoverOnetimePrivateKey(
        realTxOut.getPubKey(),
        realTxOut.getTargetKey(),
        senderAccountKey
    );
    transactionBuilder
        .addInput(txOuts, txOutMembershipProofs, realIndex, onetimePrivateKey,
            senderAccountKey.getViewKey());
    long fee = 1L;
    transactionBuilder.setFee(fee);
    transactionBuilder.setTombstoneBlockIndex(UnsignedLong.valueOf(2000));
    BigInteger sentTxOutValue = BigInteger.ONE;

    transactionBuilder.addOutput(sentTxOutValue, recipientAccountKey.getPublicAddress(), null);
    BigInteger realTxOutValue = realTxOut.getAmount()
        .unmaskAmount(senderAccountKey.getViewKey(), realTxOut.getPubKey());
    BigInteger changeValue = realTxOutValue.subtract(BigInteger.valueOf(fee))
        .subtract(sentTxOutValue);
    transactionBuilder.addChangeOutput(changeValue, senderAccountKey, null);
    Transaction transaction = transactionBuilder.build();

    List<MobileCoinAPI.TxOut> outputsList = transaction.toProtoBufObject().getPrefix()
        .getOutputsList();
    TxOut txOut1 = TxOut.fromProtoBufObject(outputsList.get(0));
    TxOut txOut2 = TxOut.fromProtoBufObject(outputsList.get(1));

    TxOut sentTxOut;
    try {
      txOut1.getAmount().unmaskAmount(recipientAccountKey.getViewKey(), txOut1.getPubKey());
      sentTxOut = txOut1;
    } catch(Exception e) {
      sentTxOut = txOut2;
    }

    byte[] sentWithPaymentRequestMemoPayload = sentTxOut.decryptMemoPayload(recipientAccountKey);

    AddressHash senderAddressHash = senderAccountKey.getPublicAddress().calculateAddressHash();
    SenderWithPaymentRequestMemo senderWithPaymentRequestMemo = (SenderWithPaymentRequestMemo) TxOutMemoParser
        .parseTxOutMemo(sentWithPaymentRequestMemoPayload, recipientAccountKey, sentTxOut);
    assertEquals(senderAddressHash, senderWithPaymentRequestMemo.getUnvalidatedAddressHash());
    SenderWithPaymentRequestMemoData senderWithPaymentRequestMemoData = senderWithPaymentRequestMemo
        .getSenderWithPaymentRequestMemoData(senderAccountKey.getPublicAddress(), recipientAccountKey.getDefaultSubAddressViewKey());

    assertEquals(senderAddressHash, senderWithPaymentRequestMemoData.getAddressHash());
    assertEquals(paymentRequestId, senderWithPaymentRequestMemoData.getPaymentRequestId());
  }

  @Test
  public void buildTransaction_senderAndDestinationMemoBuilder_txBuidlerRespectsBlockVersion() throws Exception {
    TxOutMemoBuilder txOutMemoBuilder = TxOutMemoBuilder
            .createSenderAndDestinationRTHMemoBuilder(senderAccountKey);
    TxOut realTxOut = txOuts.get(realIndex);
    transactionBuilder = new TransactionBuilder(fogResolver, txOutMemoBuilder, MEMO_BLOCK_VERSION - 1);

    RistrettoPrivate onetimePrivateKey = Util.recoverOnetimePrivateKey(
            realTxOut.getPubKey(),
            realTxOut.getTargetKey(),
            senderAccountKey
    );
    transactionBuilder
            .addInput(txOuts, txOutMembershipProofs, realIndex, onetimePrivateKey,
                    senderAccountKey.getViewKey());
    long fee = 1L;
    transactionBuilder.setFee(fee);
    transactionBuilder.setTombstoneBlockIndex(UnsignedLong.valueOf(2000));
    BigInteger sentTxOutValue = BigInteger.ONE;

    transactionBuilder.addOutput(sentTxOutValue, recipientAccountKey.getPublicAddress(), null);
    BigInteger realTxOutValue = realTxOut.getAmount()
            .unmaskAmount(senderAccountKey.getViewKey(), realTxOut.getPubKey());
    BigInteger changeValue = realTxOutValue.subtract(BigInteger.valueOf(fee))
            .subtract(sentTxOutValue);
    transactionBuilder.addChangeOutput(changeValue, senderAccountKey, null);
    Transaction transaction = transactionBuilder.build();

    List<MobileCoinAPI.TxOut> outputsList = transaction.toProtoBufObject().getPrefix()
            .getOutputsList();
    TxOut txOut1 = TxOut.fromProtoBufObject(outputsList.get(0));
    TxOut txOut2 = TxOut.fromProtoBufObject(outputsList.get(1));

    TxOut sentTxOut;
    try {
      txOut1.getAmount().unmaskAmount(recipientAccountKey.getViewKey(), txOut1.getPubKey());
      sentTxOut = txOut1;
    } catch(Exception e) {
      sentTxOut = txOut2;
    }

    byte[] sentMemoPayload = sentTxOut.decryptMemoPayload(recipientAccountKey);

    TxOutMemo unsetMemo = TxOutMemoParser
            .parseTxOutMemo(sentMemoPayload, recipientAccountKey, sentTxOut);

    assertEquals(TxOutMemoType.NOT_SET, unsetMemo.getTxOutMemoType());
  }

  private static FogResolver createFogResolver() throws Exception {
    FogReportResponses fogReportResponses = new FogReportResponses();
    Uri fogUri = Uri.parse(fogAlphaUri);
    ReportResponse reportResponse = new ReportResponse(Hex.toByteArray(serializedAlphaNetReportResponse));
    fogReportResponses.addResponse(fogUri, reportResponse);
    Verifier verifier = new Verifier();

    return new FogResolver(fogReportResponses,  verifier);
  }

  private static List<TxOut> createTxOutList() throws Exception {
    List<TxOut> txOuts = new ArrayList<>();
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut1)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut2)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut3)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut4)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut5)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut6)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut7)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut8)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut9)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut10)));
    txOuts.add(TxOut.fromBytes(Hex.toByteArray(serializedNativeTxOut11)));

    return txOuts;
  }


  private static List<TxOutMembershipProof> createTxOutMembershipProofs() throws Exception {
    List<TxOutMembershipProof> txOutMembershipProofs = new ArrayList<>();
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof1)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof2)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof3)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof4)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof5)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof6)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof7)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof8)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof9)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof10)));
    txOutMembershipProofs
        .add(new TxOutMembershipProof(Hex.toByteArray(serializedTxOutMembershipProof11)));

    return txOutMembershipProofs;
  }
}